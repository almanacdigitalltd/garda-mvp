{% requireLogin %}

{% extends "_layouts/_base.twig" %}

{% set products = craft.entries()
    .section('products')
    .productCategory(category)
    .all()
%}

{% block content %}

    {% if category %}
    <h1>{{ category.title }}</h1>
    {% endif %}

    <div class="c-product-list">
    {% for product in products %}
        
        {# Gets the first image / refs the field name #}
        {% set productImage = product.productImage.one() %}

        <div class="c-product-list__item">
        
            <div class="c-product-list__image">
                {% if productImage %}
                    {# getImg creates the image tag #}
                    {{ productImage.getImg() }}
                {% endif %}
            </div>
            
            <h2 class="c-product-list__title">
                <a class="c-product-list__link" href="{{ product.url }}">{{ product.title }}</a>
            </h2>
            
            <div class="c-product-list__brand">{{ product.productBrand }}</div>
            
        </div>
        <br>

    {% endfor %}
    </div>

{% endblock %}